<!--pages/user/problem-list/problem-list.wxml-->
<view class="problem-list-container">
  <!-- ç­›é€‰æ  -->
  <view class="filter-section">
    <view class="filter-tabs">
      <view 
        class="filter-tab {{currentFilter === 'all' ? 'active' : ''}}" 
        bindtap="changeFilter" 
        data-filter="all"
      >
        <text class="tab-text">å…¨éƒ¨</text>
      </view>
      <view 
        class="filter-tab {{currentFilter === 'pending' ? 'active' : ''}}" 
        bindtap="changeFilter" 
        data-filter="pending"
      >
        <text class="tab-text">å¾…å¤„ç†</text>
      </view>
      <view 
        class="filter-tab {{currentFilter === 'processing' ? 'active' : ''}}" 
        bindtap="changeFilter" 
        data-filter="processing"
      >
        <text class="tab-text">å¤„ç†ä¸­</text>
      </view>
      <view 
        class="filter-tab {{currentFilter === 'fixed' ? 'active' : ''}}" 
        bindtap="changeFilter" 
        data-filter="fixed"
      >
        <text class="tab-text">å·²æ•´æ”¹</text>
      </view>
    </view>
  </view>

  <!-- é—®é¢˜åˆ—è¡¨ -->
  <view class="problem-list">
    <view class="problem-item" wx:for="{{problems}}" wx:key="id" bindtap="viewProblemDetail" data-id="{{item.id}}">
      <view class="problem-header">
        <text class="problem-title">{{item.title}}</text>
        <view class="problem-status {{item.status}}">
          <text class="status-text">{{item.statusText}}</text>
        </view>
      </view>
      
      <text class="problem-desc">{{item.description}}</text>
      
      <view class="problem-meta">
        <view class="meta-item">
          <text class="meta-label">åˆ†ç±»:</text>
          <text class="meta-value">{{item.categoryText}}</text>
        </view>
        <view class="meta-item">
          <text class="meta-label">ä¸¥é‡ç¨‹åº¦:</text>
          <text class="meta-value severity-{{item.severity}}">{{item.severityText}}</text>
        </view>
      </view>
      
      <view class="problem-photos">
        <image 
          wx:for="{{item.photos}}" 
          wx:for-item="photo" 
          wx:key="*this" 
          src="{{photo}}" 
          mode="aspectFill"
          bindtap="previewPhoto" 
          data-photos="{{item.photos}}" 
          data-current="{{photo}}"
        ></image>
      </view>
      
      <view class="problem-footer">
        <text class="problem-time">{{item.createTime}}</text>
        <view class="problem-actions">
          <view class="action-btn" wx:if="{{item.status === 'pending' || item.status === 'processing'}}" bindtap="uploadFix" data-id="{{item.id}}" catchtap="true">
            <text class="action-text">ä¸Šä¼ æ•´æ”¹</text>
          </view>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{problems.length === 0 && !loading}}">
      <text class="empty-icon">ğŸ“‹</text>
      <text class="empty-text">æš‚æ— é—®é¢˜è®°å½•</text>
      <text class="empty-desc">å½“å‰ç­›é€‰æ¡ä»¶ä¸‹æ²¡æœ‰æ‰¾åˆ°é—®é¢˜</text>
    </view>

    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading-state" wx:if="{{loading}}">
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>
  </view>

  <!-- åŠ è½½æ›´å¤š -->
  <view class="load-more" wx:if="{{hasMore && !loading}}">
    <button class="load-more-btn" bindtap="loadMore">åŠ è½½æ›´å¤š</button>
  </view>
</view>
