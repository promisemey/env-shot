<!--pages/index/index.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨æ¬¢è¿åŒºåŸŸ -->
  <view class="welcome-section">
    <view class="welcome-content">
      <text class="welcome-text">æ¬¢è¿ä½¿ç”¨</text>
      <text class="app-name">ç¤¾åŒºç¯å¢ƒç®¡ç†</text>
      <text class="user-info">{{userInfo.name || 'ç”¨æˆ·'}}ï¼Œ{{userInfo.role === 'admin' ? 'ç®¡ç†å‘˜' : 'ç¤¾åŒºç”¨æˆ·'}}</text>
    </view>
    <image class="welcome-bg" src="/images/welcome-bg.png" mode="aspectFill"></image>
  </view>

  <!-- åŠŸèƒ½èœå• -->
  <view class="menu-section">
    <view class="section-title">
      <text class="title">åŠŸèƒ½èœå•</text>
    </view>
    
    <view class="menu-grid">
      <!-- ç®¡ç†å‘˜åŠŸèƒ½ -->
      <block wx:if="{{userInfo.role === 'admin'}}">
        <view class="menu-item" bindtap="navigateTo" data-url="/pages/admin/community-select/community-select">
          <view class="menu-icon admin-icon">
            <text class="icon">ğŸ˜ï¸</text>
          </view>
          <text class="menu-text">é€‰æ‹©ç¤¾åŒº</text>
        </view>
        
        <view class="menu-item" bindtap="navigateTo" data-url="/pages/admin/problem-upload/problem-upload">
          <view class="menu-icon admin-icon">
            <text class="icon">ğŸ“·</text>
          </view>
          <text class="menu-text">ä¸Šä¼ é—®é¢˜</text>
        </view>
        
        <view class="menu-item" bindtap="navigateTo" data-url="/pages/admin/problem-monitor/problem-monitor">
          <view class="menu-icon admin-icon">
            <text class="icon">ğŸ“Š</text>
          </view>
          <text class="menu-text">é—®é¢˜ç›‘æ§</text>
        </view>
      </block>

      <!-- æ™®é€šç”¨æˆ·åŠŸèƒ½ -->
      <block wx:else>
        <view class="menu-item" bindtap="navigateTo" data-url="/pages/user/problem-list/problem-list">
          <view class="menu-icon user-icon">
            <text class="icon">ğŸ“‹</text>
          </view>
          <text class="menu-text">é—®é¢˜åˆ—è¡¨</text>
        </view>
        
        <view class="menu-item" bindtap="navigateTo" data-url="/pages/user/upload-fix/upload-fix">
          <view class="menu-icon user-icon">
            <text class="icon">âœ…</text>
          </view>
          <text class="menu-text">ä¸Šä¼ æ•´æ”¹</text>
        </view>
      </block>
    </view>
  </view>

  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="stats-section">
    <view class="section-title">
      <text class="title">æ•°æ®ç»Ÿè®¡</text>
    </view>
    
    <view class="stats-grid">
      <view class="stats-item">
        <text class="stats-number">{{stats.totalProblems}}</text>
        <text class="stats-label">æ€»é—®é¢˜æ•°</text>
      </view>
      
      <view class="stats-item">
        <text class="stats-number">{{stats.pendingProblems}}</text>
        <text class="stats-label">å¾…å¤„ç†</text>
      </view>
      
      <view class="stats-item">
        <text class="stats-number">{{stats.fixedProblems}}</text>
        <text class="stats-label">å·²æ•´æ”¹</text>
      </view>
      
      <view class="stats-item">
        <text class="stats-number">{{stats.fixRate}}%</text>
        <text class="stats-label">æ•´æ”¹ç‡</text>
      </view>
    </view>
  </view>

  <!-- æœ€è¿‘é—®é¢˜ -->
  <view class="recent-section">
    <view class="section-title">
      <text class="title">æœ€è¿‘é—®é¢˜</text>
      <text class="more" bindtap="navigateTo" data-url="/pages/user/problem-list/problem-list">æ›´å¤š ></text>
    </view>
    
    <view class="problem-list">
      <view class="problem-item" wx:for="{{recentProblems}}" wx:key="id" bindtap="viewProblemDetail" data-id="{{item.id}}">
        <view class="problem-content">
          <text class="problem-title">{{item.title}}</text>
          <text class="problem-desc">{{item.description}}</text>
          <view class="problem-meta">
            <text class="problem-time">{{item.createTime}}</text>
            <text class="problem-status {{item.status}}">{{item.statusText}}</text>
          </view>
        </view>
        <view class="problem-photo">
          <image src="{{item.photos[0]}}" mode="aspectFill"></image>
        </view>
      </view>
      
      <view class="empty-state" wx:if="{{recentProblems.length === 0}}">
        <text class="empty-text">æš‚æ— é—®é¢˜è®°å½•</text>
      </view>
    </view>
  </view>
</view>
