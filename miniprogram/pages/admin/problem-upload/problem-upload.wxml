<!--pages/admin/problem-upload/problem-upload.wxml-->
<view class="upload-container">
  <!-- 社区选择 -->
  <view class="form-section">
    <view class="form-item">
      <text class="form-label">选择社区 *</text>
      <picker 
        class="form-picker" 
        range="{{communities}}" 
        range-key="name" 
        value="{{selectedCommunityIndex}}" 
        bindchange="onCommunityChange"
      >
        <view class="picker-display">
          <text class="picker-text">{{selectedCommunityText}}</text>
          <text class="picker-arrow">></text>
        </view>
      </picker>
    </view>
  </view>

  <!-- 照片上传 -->
  <view class="photo-section">
    <view class="section-header">
      <text class="section-title">问题照片 *</text>
      <text class="photo-count">{{photos.length}}/9</text>
    </view>
    
    <view class="photo-grid">
      <view class="photo-item" wx:for="{{photos}}" wx:key="index">
        <image src="{{item}}" mode="aspectFill" bindtap="previewPhoto" data-index="{{index}}"></image>
        <view class="photo-delete" bindtap="deletePhoto" data-index="{{index}}">
          <text class="delete-icon">×</text>
        </view>
      </view>
      
      <view class="photo-add" wx:if="{{photos.length < 9}}" bindtap="choosePhoto">
        <text class="add-icon">+</text>
        <text class="add-text">添加照片</text>
      </view>
    </view>
  </view>

  <!-- 位置信息 -->
  <view class="location-section">
    <view class="section-header">
      <text class="section-title">位置信息</text>
      <text class="location-btn" bindtap="getCurrentLocation">获取位置</text>
    </view>
    
    <view class="location-info" wx:if="{{location}}">
      <text class="location-address">{{location.address}}</text>
      <text class="location-coords">经度: {{location.longitude}}, 纬度: {{location.latitude}}</text>
    </view>
  </view>

  <!-- 提交按钮 -->
  <view class="submit-section">
    <button 
      class="submit-btn {{submitDisabled ? 'disabled' : ''}}" 
      bindtap="submitProblem"
      disabled="{{submitDisabled}}"
    >
      {{submitBtnText}}
    </button>
  </view>
</view>
